[gd_scene load_steps=31 format=3 uid="uid://bp6qss41chrho"]

[ext_resource type="Script" uid="uid://bikrhnp7h2fj6" path="res://scripts/pothole_spawner.gd" id="1_o5qli"]
[ext_resource type="Script" uid="uid://dwnwtqxdffhvo" path="res://scripts/game_manager.gd" id="1_tbgi4"]
[ext_resource type="PackedScene" uid="uid://bl8poaryl3h53" path="res://scenes/prefabs/vehicle-areas/pothole.tscn" id="2_0wfyh"]
[ext_resource type="Texture2D" uid="uid://bu62cj0cvja48" path="res://assets/art/bg-dommasandra.png" id="2_tipki"]
[ext_resource type="Script" uid="uid://cqp60ymv8d6c2" path="res://scripts/car_spawner.gd" id="3_jyhfs"]
[ext_resource type="Script" uid="uid://d0g0a2kvadj5b" path="res://scripts/car_spawner_manager.gd" id="5_85g3d"]
[ext_resource type="PackedScene" uid="uid://0ej7nf4ws53l" path="res://scenes/prefabs/vehicle-areas/stop_area.tscn" id="7_o6xl0"]
[ext_resource type="Script" uid="uid://payarb4yxwap" path="res://scripts/game_over_camera2d.gd" id="8_eb6dy"]
[ext_resource type="PackedScene" uid="uid://2nekctgyyoj4" path="res://scenes/prefabs/ui/powerup-button.tscn" id="9_choun"]
[ext_resource type="Theme" uid="uid://bgbm0bam5qsyn" path="res://assets/theme.tres" id="9_ya4ey"]
[ext_resource type="Texture2D" uid="uid://dsn0eas0lvlea" path="res://assets/art/icons/pothole-clear.png" id="10_ya4ey"]
[ext_resource type="PackedScene" uid="uid://b2rvg70uwb417" path="res://scenes/prefabs/ui/citation.tscn" id="12_eb6dy"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_85g3d"]
size = Vector2(136, 82)

[sub_resource type="Curve2D" id="Curve2D_tipki"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 86, 22, -44.31719, -1.5827568, 44.31719, 1.5827568, 639, 325, 0, 0, 0, 0, 1212, 11)
}
point_count = 3

[sub_resource type="Curve2D" id="Curve2D_85g3d"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 81, 19, 0, 0, 0, 0, 1243, 667)
}
point_count = 2

[sub_resource type="Curve2D" id="Curve2D_choun"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 75, 13, 1.5026295, -18.78287, -1.5026295, 18.78287, 676, 355, 0, 0, 0, 0, 86, 707)
}
point_count = 3

[sub_resource type="Curve2D" id="Curve2D_ya4ey"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 1240, 44, 0, 0, 0, 0, 76, 713)
}
point_count = 2

[sub_resource type="Curve2D" id="Curve2D_eb6dy"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 1246, 39, -1.3995218, -14.928233, 1.3995218, 14.928233, 693, 356, 0, 0, 0, 0, 1232, 662)
}
point_count = 3

[sub_resource type="Curve2D" id="Curve2D_trceg"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 1250, 39, 11.751969, 1.7410325, -11.751969, -1.7410325, 637, 379, 0, 0, 0, 0, 49, 50)
}
point_count = 3

[sub_resource type="Curve2D" id="Curve2D_a8y0u"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 48, 670, -5.785124, 20.661156, 5.785124, -20.661156, 460, 437, 9.917355, 19.83471, -9.917355, -19.83471, 454, 279, 0, 0, 0, 0, 49, 51)
}
point_count = 4

[sub_resource type="Curve2D" id="Curve2D_jkv2x"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 50, 662, 2.2578955, 19.192112, -2.2578955, -19.192112, 599, 362, 0, 0, 0, 0, 47, 52)
}
point_count = 3

[sub_resource type="Curve2D" id="Curve2D_jbj1t"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 51, 661, 0, 0, 0, 0, 1212, 18)
}
point_count = 2

[sub_resource type="Curve2D" id="Curve2D_muem4"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 43, 672, -18.705307, -0.17985873, 18.705307, 0.17985873, 647, 337, 0, 0, 0, 0, 1232, 661, 0, 0, 0, 0, 43, 672)
}
point_count = 4

[sub_resource type="Curve2D" id="Curve2D_dp3eg"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 1213, 696, 0, 0, 0, 0, 40, 49)
}
point_count = 2

[sub_resource type="Curve2D" id="Curve2D_0ld40"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 1214, 695, 24.118427, 1.026316, -24.118427, -1.026316, 646, 383, 0, 0, 0, 0, 85, 711)
}
point_count = 3

[sub_resource type="Curve2D" id="Curve2D_gqmmt"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 1211, 695, -0.62092125, 8.071977, 0.62092125, -8.071977, 597, 361, 0, 0, 0, 0, 1197, 22)
}
point_count = 3

[sub_resource type="RectangleShape2D" id="RectangleShape2D_choun"]
size = Vector2(40, 40)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ya4ey"]
size = Vector2(40, 40)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_tipki"]
size = Vector2(40, 40)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_o6xl0"]
size = Vector2(30, 20)

[node name="Main Scene" type="Node2D" node_paths=PackedStringArray("car_spawner", "pothole_spawner")]
script = ExtResource("1_tbgi4")
car_spawner = NodePath("Spawners")
pothole_spawner = NodePath("PotholeSpawner")

[node name="Map" type="Sprite2D" parent="."]
position = Vector2(639, 361)
scale = Vector2(0.6092594, 0.60925937)
texture = ExtResource("2_tipki")

[node name="PotholeSpawner" type="Polygon2D" parent="."]
unique_name_in_owner = true
color = Color(1, 1, 1, 0)
polygon = PackedVector2Array(275, 173, 311, 135, 638, 322, 965, 146, 1007, 188, 692, 357, 1013, 538, 994, 587, 639, 384, 389, 531, 350, 506, 588, 364)
script = ExtResource("1_o5qli")
max_delay = 60.0
min_delay = 30.0
pothole_scene = ExtResource("2_0wfyh")

[node name="Spawners" type="Node2D" parent="." node_paths=PackedStringArray("spawners")]
unique_name_in_owner = true
script = ExtResource("5_85g3d")
spawners = [NodePath("North"), NodePath("East"), NodePath("West"), NodePath("South")]
bbmp_powerup_time = 5.0

[node name="North" type="Node2D" parent="Spawners"]
script = ExtResource("3_jyhfs")
max_delay = 4.0
min_delay = 3.0
metadata/_custom_type_script = "uid://cqp60ymv8d6c2"

[node name="SpawnChecker" type="Area2D" parent="Spawners/North"]
position = Vector2(96, 47)
collision_layer = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Spawners/North/SpawnChecker"]
shape = SubResource("RectangleShape2D_85g3d")

[node name="East" type="Path2D" parent="Spawners/North"]
curve = SubResource("Curve2D_tipki")

[node name="South" type="Path2D" parent="Spawners/North"]
curve = SubResource("Curve2D_85g3d")

[node name="West" type="Path2D" parent="Spawners/North"]
curve = SubResource("Curve2D_choun")

[node name="East" type="Node2D" parent="Spawners"]
script = ExtResource("3_jyhfs")
max_delay = 4.0
min_delay = 3.0

[node name="SpawnChecker" type="Area2D" parent="Spawners/East"]
position = Vector2(1197, 52)
collision_layer = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Spawners/East/SpawnChecker"]
shape = SubResource("RectangleShape2D_85g3d")

[node name="West" type="Path2D" parent="Spawners/East"]
curve = SubResource("Curve2D_ya4ey")

[node name="South" type="Path2D" parent="Spawners/East"]
curve = SubResource("Curve2D_eb6dy")

[node name="North" type="Path2D" parent="Spawners/East"]
curve = SubResource("Curve2D_trceg")

[node name="West" type="Node2D" parent="Spawners"]
script = ExtResource("3_jyhfs")
max_delay = 4.0
min_delay = 3.0

[node name="SpawnChecker" type="Area2D" parent="Spawners/West"]
position = Vector2(78, 682)
collision_layer = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Spawners/West/SpawnChecker"]
shape = SubResource("RectangleShape2D_85g3d")

[node name="North-L" type="Path2D" parent="Spawners/West"]
curve = SubResource("Curve2D_a8y0u")

[node name="North-R" type="Path2D" parent="Spawners/West"]
curve = SubResource("Curve2D_jkv2x")

[node name="East" type="Path2D" parent="Spawners/West"]
curve = SubResource("Curve2D_jbj1t")

[node name="South" type="Path2D" parent="Spawners/West"]
curve = SubResource("Curve2D_muem4")

[node name="South" type="Node2D" parent="Spawners"]
script = ExtResource("3_jyhfs")
max_delay = 4.0
min_delay = 3.0

[node name="SpawnChecker" type="Area2D" parent="Spawners/South"]
position = Vector2(1166, 668)
collision_layer = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Spawners/South/SpawnChecker"]
shape = SubResource("RectangleShape2D_85g3d")

[node name="North" type="Path2D" parent="Spawners/South"]
curve = SubResource("Curve2D_dp3eg")

[node name="West" type="Path2D" parent="Spawners/South"]
curve = SubResource("Curve2D_0ld40")

[node name="East" type="Path2D" parent="Spawners/South"]
curve = SubResource("Curve2D_gqmmt")

[node name="Stop" type="Node2D" parent="."]

[node name="North" parent="Stop" instance=ExtResource("7_o6xl0")]
position = Vector2(578, 292)
stop_car_entirely = true
shape = SubResource("RectangleShape2D_choun")

[node name="South" parent="Stop" instance=ExtResource("7_o6xl0")]
position = Vector2(739, 440)
stop_car_entirely = true
shape = SubResource("RectangleShape2D_ya4ey")

[node name="West" parent="Stop" instance=ExtResource("7_o6xl0")]
position = Vector2(449, 437)
stop_car_entirely = true
shape = SubResource("RectangleShape2D_tipki")

[node name="East" parent="Stop" instance=ExtResource("7_o6xl0")]
position = Vector2(743, 323)
stop_car_entirely = true
shape = SubResource("RectangleShape2D_o6xl0")

[node name="Camera" type="Camera2D" parent="."]
position = Vector2(639, 361)
zoom = Vector2(2, 2)
script = ExtResource("8_eb6dy")
zoom_scale = 1.0
rect = Vector2(700, 600)

[node name="UI Layer" type="CanvasLayer" parent="."]

[node name="Game Over Screen" parent="UI Layer" instance=ExtResource("12_eb6dy")]
unique_name_in_owner = true
visible = false

[node name="UI" type="VBoxContainer" parent="UI Layer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
theme = ExtResource("9_ya4ey")

[node name="Top Spacer" type="Control" parent="UI Layer/UI"]
layout_mode = 2
size_flags_vertical = 3
size_flags_stretch_ratio = 4.0
mouse_filter = 2

[node name="Powerups" type="HBoxContainer" parent="UI Layer/UI"]
layout_mode = 2
size_flags_vertical = 3
alignment = 1

[node name="BBMP Powerup" parent="UI Layer/UI/Powerups" instance=ExtResource("9_choun")]
layout_mode = 2
lock_enabled_state = true

[node name="Pothole Clear Powerup" parent="UI Layer/UI/Powerups" instance=ExtResource("9_choun")]
visible = false
layout_mode = 2
icon = ExtResource("10_ya4ey")

[connection signal="bbmp_powerup_used" from="." to="Spawners" method="_bbmp_powerup_used"]
[connection signal="bbmp_powerup_used" from="." to="UI Layer/UI/Powerups/BBMP Powerup" method="in_effect"]
[connection signal="number_of_bbmp_changed" from="." to="UI Layer/UI/Powerups/BBMP Powerup" method="_value_changed"]
[connection signal="number_of_potholes_powerup_changed" from="." to="UI Layer/UI/Powerups/Pothole Clear Powerup" method="_value_changed"]
[connection signal="all_cars_cleared" from="Spawners" to="." method="wave_ended"]
[connection signal="bbmp_powerup_ended" from="Spawners" to="UI Layer/UI/Powerups/BBMP Powerup" method="out_of_effect"]
[connection signal="pressed" from="UI Layer/UI/Powerups/BBMP Powerup" to="." method="_use_bbmp_powerup"]
[connection signal="pressed" from="UI Layer/UI/Powerups/Pothole Clear Powerup" to="." method="_use_pothole_powerup"]
